From c6792a41ab00086ac6f13b06075d8b4d08ba5cf9 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Javier=20Jard=C3=B3n?= <jjardon@gnome.org>
Date: Sat, 23 Nov 2019 23:43:32 +0900
Subject: [PATCH] deprecated/gtkstatusicon.c: Fix compilation in wayland

Without this compilation in a wayland-only system fails
---
 gtk/deprecated/gtkstatusicon.c | 11 ++---------
 1 file changed, 2 insertions(+), 9 deletions(-)

diff --git a/gtk/deprecated/gtkstatusicon.c b/gtk/deprecated/gtkstatusicon.c
index 0c9dae62e6..52239b11cc 100644
--- a/gtk/deprecated/gtkstatusicon.c
+++ b/gtk/deprecated/gtkstatusicon.c
@@ -2272,18 +2272,11 @@ gtk_status_icon_is_embedded (GtkStatusIcon *status_icon)
   g_return_val_if_fail (GTK_IS_STATUS_ICON (status_icon), FALSE);
 
 #ifdef GDK_WINDOWING_X11
-  if (status_icon->priv->tray_icon &&
-      gtk_plug_get_embedded (GTK_PLUG (status_icon->priv->tray_icon)))
-    return TRUE;
-  else
+  if (status_icon->priv->tray_icon == NULL ||
+      !gtk_plug_get_embedded (GTK_PLUG (status_icon->priv->tray_icon)))
     return FALSE;
 #endif
-#ifdef GDK_WINDOWING_WIN32
   return TRUE;
-#endif
-#ifdef GDK_WINDOWING_QUARTZ
-  return TRUE;
-#endif
 }
 
 /**
-- 
2.23.0

