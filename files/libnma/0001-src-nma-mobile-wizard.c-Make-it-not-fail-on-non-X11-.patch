From e283f06b65cf7cf1ae03e52c24fcc0b67028228d Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Javier=20Jard=C3=B3n?= <jjardon@gnome.org>
Date: Sun, 24 Nov 2019 00:27:43 +0900
Subject: [PATCH] src/nma-mobile-wizard.c: Make it not fail on non-X11
 platforms

Tested on a wayland-only system
---
 src/nma-mobile-wizard.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/nma-mobile-wizard.c b/src/nma-mobile-wizard.c
index de30525b..b2ed0589 100644
--- a/src/nma-mobile-wizard.c
+++ b/src/nma-mobile-wizard.c
@@ -12,11 +12,13 @@
 
 #include <stdlib.h>
 
+#ifdef GDK_WINDOWING_X11
 #if GTK_CHECK_VERSION(3,90,0)
 #include <gdk/x11/gdkx.h>
 #else
 #include <gdk/gdkx.h>
 #endif
+#endif
 
 #include <NetworkManager.h>
 #include <nm-setting-gsm.h>
@@ -1459,6 +1461,7 @@ nma_mobile_wizard_init (NMAMobileWizard *self)
 	gtk_widget_init_template (GTK_WIDGET (self));
 	gtk_widget_realize (GTK_WIDGET (self));
 
+#ifdef GDK_WINDOWING_X11
 	if (GDK_IS_X11_DISPLAY (gtk_widget_get_display (GTK_WIDGET (self)))) {
 #if GTK_CHECK_VERSION(3,90,0)
 		GdkSurface *surface = gtk_widget_get_surface (GTK_WIDGET (self));
@@ -1468,6 +1471,7 @@ nma_mobile_wizard_init (NMAMobileWizard *self)
 		gdk_window_set_skip_taskbar_hint (gdk_window, TRUE);
 #endif
 	}
+#endif
 }
 
 /**
-- 
2.23.0

