From 7b9bf20c41d5b21b110499b3ebff12cddec335ef Mon Sep 17 00:00:00 2001
From: Tom Pollard <tom.pollard@codethink.co.uk>
Date: Wed, 13 May 2020 17:19:03 +0100
Subject: [PATCH] vm/prepare-image.sh: Add --setup-machine-id to
 systemd-firstboot

---
 files/vm/prepare-image.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/files/vm/prepare-image.sh b/files/vm/prepare-image.sh
index a91344bc..01dd09d1 100755
--- a/files/vm/prepare-image.sh
+++ b/files/vm/prepare-image.sh
@@ -86,7 +86,7 @@ for i in $(ls "${initial_scripts}"/*); do
 done
 
 echo "Running systemd-firstboot" 1>&2
-systemd-firstboot --root "${sysroot}" ${rootpasswd:+--root-password ${rootpasswd}} --locale en_US.UTF-8 --timezone UTC
+systemd-firstboot --root "${sysroot}" ${rootpasswd:+--root-password ${rootpasswd}} --locale en_US.UTF-8 --timezone UTC --setup-machine-id
 
 echo "Running systemctl preset-all" 1>&2
 systemctl --root "${sysroot}" preset-all
-- 
2.25.1

