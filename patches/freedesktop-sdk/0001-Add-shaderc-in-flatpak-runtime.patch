From 44c0ba07926780760e194f9bac5033454ece4a4b Mon Sep 17 00:00:00 2001
From: Erick555 <37542552+Erick555@users.noreply.github.com>
Date: Sun, 17 Mar 2024 00:00:47 +0000
Subject: [PATCH] Add shaderc split rules

Backported from https://gitlab.com/freedesktop-sdk/freedesktop-sdk/-/merge_requests/17603
---
 elements/components/shaderc.bst | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/elements/components/shaderc.bst b/elements/components/shaderc.bst
index 46887de78..51b25731f 100644
--- a/elements/components/shaderc.bst
+++ b/elements/components/shaderc.bst
@@ -21,17 +21,30 @@ config:
       # Disable git versioning
       sed -i -e '/build-version/d' glslc/CMakeLists.txt
 
       # Manually create build-version.inc as we disabled git versioning
       cat <<EOF >glslc/src/build-version.inc
       "shaderc $(git describe | sed 's/^v//')"
       "spriv-tools $(spirv-cfg --version | sed '/^SPIRV-Tools v\([^ ]*\) .*$/{;s//\1/;q;};d')"
       "glslang $(glslangValidator --version | sed '/^Glslang Version: /{;s///;q;};d')"
       EOF
 
+public:
+  bst:
+    split-rules:
+      devel:
+        (>):
+        - '%{bindir}'
+        - '%{bindir}/**'
+        - '%{libdir}/libshaderc_shared.so'
+        
+      static-blocklist:
+        (>):
+        - "%{libdir}/*.a"
+
 sources:
 - kind: git_repo
   url: github:google/shaderc.git
   track: v*
   ref: v2023.8-0-ge6edd6d48fa5bdd9d176794c6810fae7f8e938e1
 - kind: patch
   path: patches/shaderc/what-a-mess.patch
-- 
2.44.0

