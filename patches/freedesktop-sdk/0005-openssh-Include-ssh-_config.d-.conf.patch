From b4eb684892aad3826e256f88f17d3d91732df832 Mon Sep 17 00:00:00 2001
From: Valentin David <me@valentindavid.com>
Date: Sun, 26 Oct 2025 16:06:02 +0100
Subject: [PATCH 5/6] openssh: Include ssh*_config.d/*.conf

Most distributions include system-wide configuration fragments from
and some software expect it: systemd, libvirt.
---
 elements/components/openssh.bst | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

diff --git a/elements/components/openssh.bst b/elements/components/openssh.bst
index 87e8076a7..a8f0b952a 100644
--- a/elements/components/openssh.bst
+++ b/elements/components/openssh.bst
@@ -33,6 +33,20 @@ variables:
     %{arch_options}
 
 config:
+  configure-commands:
+    (<):
+    - |
+      cat <<EOF >>"sshd_config"
+
+      Include %{sysconfdir}/sshd_config.d/*.conf
+      EOF
+
+    - |
+      cat <<EOF >>"ssh_config"
+
+      Include %{sysconfdir}/ssh_config.d/*.conf
+      EOF
+
   install-commands:
     (>):
     - |
-- 
2.51.0

